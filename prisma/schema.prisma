generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model account {
  account_id    Int          @id @default(autoincrement())
  username      String       @unique(map: "username") @db.VarChar(100)
  password_hash String       @db.VarChar(255)
  role          account_role @default(ADMIN)
  created_at    DateTime     @default(now()) @db.Timestamp(0)
  updated_at    DateTime?    @db.Timestamp(0)
}

model applicants {
  applicants_id Int                       @id @default(autoincrement())
  user_id       Int
  vacancy_id    Int
  current_stage applicants_current_stage?
  created_at    DateTime                  @default(now()) @db.Timestamp(0)
  updated_at    DateTime?                 @db.Timestamp(0)

  // ğŸ”— Relasi
  user    users                @relation(fields: [user_id], references: [user_id])
  vacancy vacancies            @relation(fields: [vacancy_id], references: [vacancies_id])
  details applicants_details[]

  @@unique([user_id, vacancy_id], map: "uniq_user_vacancy")
  @@index([vacancy_id], map: "fk_app_vacancy")
}

model applicants_details {
  detail_applicants_id Int                       @id @default(autoincrement())
  applicants_id        Int
  vacancy_id           Int // relasi ke lowongan spesifik
  stage                applicants_details_stage
  status               applicants_details_status
  notes                String?                   @db.Text
  penilaian            String?                   @db.VarChar(50) // contoh "85/100"
  schedule_at          DateTime?                 @db.DateTime(0)
  created_at           DateTime                  @default(now()) @db.Timestamp(0)
  updated_at           DateTime?                 @db.Timestamp(0)

  // Relasi
  applicant applicants @relation(fields: [applicants_id], references: [applicants_id])
  vacancy   vacancies  @relation(fields: [vacancy_id], references: [vacancies_id])

  @@index([applicants_id], map: "applicants_details_applicants_id_fkey")
  @@index([vacancy_id], map: "applicants_details_vacancy_id_fkey")
}

model documents_files {
  documents_files_id Int      @id @default(autoincrement())
  cv_path            String?  @db.VarChar(255)
  id_card_path       String?  @db.VarChar(255)
  certificate_path   String?  @db.VarChar(255)
  photo_path         String?  @db.VarChar(255)
  created_at         DateTime @default(now()) @db.Timestamp(0)
  updated_at         DateTime @default(now()) @db.Timestamp(0)

  // ğŸ”— Relasi
  users users[]
}

model users {
  user_id              Int                      @id @default(autoincrement())
  NIK                  String?                  @unique(map: "NIK") @db.VarChar(16)
  full_name            String                   @db.VarChar(200)
  gender               users_gender?
  place_of_birth       String?                  @db.VarChar(100)
  date_of_birth        DateTime?                @db.Date
  documents_files_id   Int?
  phone_number         String?                  @db.VarChar(50)
  email                String?                  @unique(map: "email") @db.VarChar(150)
  marital_status       String?                  @db.VarChar(50)
  religion             String?                  @db.VarChar(50)
  address              String?                  @db.VarChar(255)
  village              String?                  @db.VarChar(100)
  subdistrict          String?                  @db.VarChar(100)
  district_town        String?                  @db.VarChar(100)
  province             String?                  @db.VarChar(100)
  university_school    String?                  @db.VarChar(150)
  department_faculty   String?                  @db.VarChar(150)
  study_program        String?                  @db.VarChar(150)
  educational_level    users_educational_level?
  GPA_grades           Int?
  work_experience      users_work_experience?
  banned_until         DateTime?                @db.Date
  personality_test_url String?                  @db.VarChar(255)
  created_at           DateTime                 @default(now()) @db.Timestamp(0)
  updated_at           DateTime?                @db.Timestamp(0)

  // ğŸ”— Relasi
  documents documents_files? @relation(fields: [documents_files_id], references: [documents_files_id])

  applicants applicants[]

  @@index([documents_files_id], map: "users_documents_files_id_fkey")
}

model vacancies {
  vacancies_id     Int               @id @default(autoincrement())
  title            String            @db.VarChar(200)
  type             vacancies_type
  degree           vacancies_degree?
  qualification    String?           @db.Text
  responsibilities String?           @db.Text
  documents        String?           @db.Text
  benefit          String?           @db.Text
  deadline         DateTime?         @db.Date
  level            vacancies_level?
  is_open          Boolean           @default(true)
  created_at       DateTime          @default(now()) @db.Timestamp(0)
  updated_at       DateTime?         @db.Timestamp(0)

  applicants applicants[]
  details    applicants_details[]
}

enum applicants_details_stage {
  HR_INT
  SKILL_TEST
  USER_INT
  FINAL_INT
  OFFERING
}

enum vacancies_type {
  Full_Time  @map("Full-Time")
  Internship
  Freelance
}

enum vacancies_level {
  Staff
  Pejuang
}

enum account_role {
  ADMIN
  PENGAWAS
  INTERVIEWER
}

enum applicants_current_stage {
  HR_INT
  SKILL_TEST
  USER_INT
  FINAL_INT
  OFFERING
  HIRED
  REJECTED
}

enum users_gender {
  MALE
  FEMALE
}

enum applicants_details_status {
  RECOMMENDED
  NOT_RECOMMENDED
  CONSIDERED
  HOLD
}

enum vacancies_degree {
  SMP
  SMA_SMK
  Diploma
  Sarjana
  Magister
}

enum users_educational_level {
  SMP
  SMA_SMK  @map("SMA/SMK")
  Diploma
  Sarjana
  Magister
}

enum users_work_experience {
  FRESH_GRADUATES       @map("fresh_graduates")
  ONE_TO_THREE_YEARS    @map("1 - 3 years")
  THREE_TO_FIVE_YEARS   @map("3 - 5 years")
  MORE_THAN_FIVE_YEARS  @map("> 5 years")
}